{"version":3,"sources":["all.js","delete-modal copy.js","login.js","pagination.js","update-modal.js","update.js"],"names":["url","path","deletemodal","props","methods","deleteProduct","newUrl","tempProduct","id","axios","data","then","res","deleteModal","hide","$emit","error","console","dir","template","loginApp","Vue","createApp","user","username","password","login","post","token","expired","document","cookie","Date","window","alert","message","location","href","mount","pagination","updatemodal","updateProduct","method","isNew","updateModal","updateApp","products","imagesUrl","checkLogin","getProducts","page","get","openModal","status","product","show","components","mounted","replace","defaults","headers","common","bootstrap","Modal","getElementById"],"mappings":";;AAAA,IAAMA,GAAG,GAAG,yCAAZ;AACA,IAAMC,IAAI,GAAG,eAAb;;;ACDA,IAAMC,WAAW,GAAG;AAChBC,EAAAA,KAAK,EAAE,CAAC,aAAD,CADS;AAEhBC,EAAAA,OAAO,EAAE;AACLC,IAAAA,aADK,2BACW;AAAA;;AACZ,UAAIC,MAAM,aAAMN,GAAN,kBAAiBC,IAAjB,4BAAuC,KAAKM,WAAL,CAAiBC,EAAxD,CAAV;AACAC,MAAAA,KAAK,UAAL,CAAaH,MAAb,EAAqB;AAAEI,QAAAA,IAAI,EAAE,KAAKH;AAAb,OAArB,EACCI,IADD,CACM,UAACC,GAAD,EAAS;AACXC,QAAAA,WAAW,CAACC,IAAZ;;AACA,QAAA,KAAI,CAACC,KAAL,CAAW,cAAX;AACH,OAJD,WAKO,UAACC,KAAD,EAAW;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,OAPD;AAQH;AAXI,GAFO;AAehBG,EAAAA,QAAQ;AAfQ,CAApB;;;ACAA;AACA,IAAMC,QAAQ,GAAGC,GAAG,CAACC,SAAJ,CAAe;AAC5BZ,EAAAA,IAD4B,kBACrB;AACH,WAAO;AACHa,MAAAA,IAAI,EAAE;AACFC,QAAAA,QAAQ,EAAE,EADR;AAEFC,QAAAA,QAAQ,EAAE;AAFR;AADH,KAAP;AAMH,GAR2B;AAU5BrB,EAAAA,OAAO,EAAE;AACLsB,IAAAA,KADK,mBACI;AACLjB,MAAAA,KAAK,CAACkB,IAAN,WAAc3B,GAAd,oBAAkC,KAAKuB,IAAvC,EACCZ,IADD,CACM,UAACC,GAAD,EAAS;AACX;AACA,wBAA2BA,GAAG,CAACF,IAA/B;AAAA,YAAQkB,KAAR,aAAQA,KAAR;AAAA,YAAeC,OAAf,aAAeA,OAAf;AACAC,QAAAA,QAAQ,CAACC,MAAT,uBAA+BH,KAA/B,uBAAiD,IAAII,IAAJ,CAASH,OAAT,CAAjD,UAHW,CAIX;;AACAI,QAAAA,MAAM,CAACC,KAAP,WAAgBtB,GAAG,CAACF,IAAJ,CAASyB,OAAzB;AACAF,QAAAA,MAAM,CAACG,QAAP,CAAgBC,IAAhB,GAAuB,qBAAvB;AACH,OARD,WASO,UAACrB,KAAD,EAAW;AACdiB,QAAAA,MAAM,CAACC,KAAP;AACAjB,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,OAZD;AAaH;AAfI;AAVmB,CAAf,CAAjB;AA8BEI,QAAQ,CAACkB,KAAT,CAAe,WAAf;;;AC/BF,IAAMC,UAAU,GAAG;AACfpC,EAAAA,KAAK,EAAE,CAAC,OAAD,CADQ;AAEfgB,EAAAA,QAAQ;AAFO,CAAnB;;;ACAA,IAAMqB,WAAW,GAAG;AAChBrC,EAAAA,KAAK,EAAE,CAAC,aAAD,EAAgB,OAAhB,CADS;AAEhBC,EAAAA,OAAO,EAAE;AACLqC,IAAAA,aADK,2BACW;AAAA;;AACZ,UAAInC,MAAM,aAAMN,GAAN,kBAAiBC,IAAjB,mBAAV;AACA,UAAIyC,MAAM,GAAG,MAAb,CAFY,CAGZ;;AACA,UAAI,CAAC,KAAKC,KAAV,EAAiB;AACbrC,QAAAA,MAAM,aAAMN,GAAN,kBAAiBC,IAAjB,4BAAuC,KAAKM,WAAL,CAAiBC,EAAxD,CAAN;AACAkC,QAAAA,MAAM,GAAG,KAAT;AACH;;AAEDjC,MAAAA,KAAK,CAACiC,MAAD,CAAL,CAAcpC,MAAd,EAAsB;AAAEI,QAAAA,IAAI,EAAE,KAAKH;AAAb,OAAtB,EACCI,IADD,CACM,UAACC,GAAD,EAAS;AACX,QAAA,KAAI,CAACG,KAAL,CAAW,cAAX;;AACA6B,QAAAA,WAAW,CAAC9B,IAAZ;AACH,OAJD,WAKO,UAACE,KAAD,EAAW;AACdC,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,OAPD;AAQH;AAlBI,GAFO;AAsBhBG,EAAAA,QAAQ;AAtBQ,CAApB;;;;;;;;;ACAA,IAAIyB,WAAW,GAAG,EAAlB;AACA,IAAI/B,WAAW,GAAG,EAAlB;AAEA,IAAMgC,SAAS,GAAGxB,GAAG,CAACC,SAAJ,CAAe;AAC7BZ,EAAAA,IAD6B,kBACtB;AACH,WAAO;AACHoC,MAAAA,QAAQ,EAAE,EADP;AAEHvC,MAAAA,WAAW,EAAE;AACTwC,QAAAA,SAAS,EAAE;AADF,OAFV;AAKHJ,MAAAA,KAAK,EAAE,KALJ;AAMHJ,MAAAA,UAAU,EAAE;AANT,KAAP;AAQH,GAV4B;AAY7BnC,EAAAA,OAAO,EAAE;AACL4C,IAAAA,UADK,wBACQ;AAAA;;AACTvC,MAAAA,KAAK,CAACkB,IAAN,WAAc3B,GAAd,sBACCW,IADD,CACM,UAACC,GAAD,EAAS;AACX,QAAA,KAAI,CAACqC,WAAL;AACH,OAHD,WAIO,UAACjC,KAAD,EAAW;AACdiB,QAAAA,MAAM,CAACC,KAAP;AACAD,QAAAA,MAAM,CAACG,QAAP,CAAgBC,IAAhB,GAAuB,YAAvB;AACH,OAPD;AAQH,KAVI;AAWLY,IAAAA,WAXK,yBAWiB;AAAA;;AAAA,UAAVC,IAAU,uEAAH,CAAG;AAClB;AACAzC,MAAAA,KAAK,CAAC0C,GAAN,WAAanD,GAAb,kBAAwBC,IAAxB,kCAAoDiD,IAApD,GACCvC,IADD,CACM,UAACC,GAAD,EAAS;AACX,QAAA,MAAI,CAACkC,QAAL,GAAgBlC,GAAG,CAACF,IAAJ,CAASoC,QAAzB;AACA,QAAA,MAAI,CAACP,UAAL,GAAkB3B,GAAG,CAACF,IAAJ,CAAS6B,UAA3B;AACH,OAJD,WAKO,UAACvB,KAAD,EAAW;AACdiB,QAAAA,MAAM,CAACC,KAAP,CAAa,OAAb;AACH,OAPD;AAQH,KArBI;AAsBLkB,IAAAA,SAtBK,qBAsBKC,MAtBL,EAsBaC,OAtBb,EAsBsB;AACvB;AACA,UAAID,MAAM,KAAK,OAAf,EAAwB;AACpB,aAAK9C,WAAL,GAAmB;AACfwC,UAAAA,SAAS,EAAE;AADI,SAAnB;AAGAH,QAAAA,WAAW,CAACW,IAAZ;AACA,aAAKZ,KAAL,GAAa,IAAb;AACH,OAND,MAMO,IAAIU,MAAM,KAAK,MAAf,EAAuB;AAC1B,aAAK9C,WAAL,qBAAwB+C,OAAxB;AACAV,QAAAA,WAAW,CAACW,IAAZ,GAF0B,CAG9B;AACC,OAJM,MAIA,IAAIF,MAAM,KAAK,QAAf,EAAyB;AAC5B,aAAK9C,WAAL,qBAAwB+C,OAAxB;AACAzC,QAAAA,WAAW,CAAC0C,IAAZ;AACH;AACJ;AAtCI,GAZoB;AAsD7BC,EAAAA,UAAU,EAAE;AACRjB,IAAAA,UAAU,EAAVA,UADQ;AAERC,IAAAA,WAAW,EAAXA,WAFQ;AAGRtC,IAAAA,WAAW,EAAXA;AAHQ,GAtDiB;AA4D7BuD,EAAAA,OA5D6B,qBA4DnB;AACN,QAAM7B,KAAK,GAAGE,QAAQ,CAACC,MAAT,CAAgB2B,OAAhB,CAAwB,kDAAxB,EAA4E,IAA5E,CAAd;AACAjD,IAAAA,KAAK,CAACkD,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiDjC,KAAjD;AAEA,SAAKoB,UAAL;AAEAJ,IAAAA,WAAW,GAAG,IAAIkB,SAAS,CAACC,KAAd,CAAoBjC,QAAQ,CAACkC,cAAT,CAAwB,aAAxB,CAApB,CAAd;AACAnD,IAAAA,WAAW,GAAG,IAAIiD,SAAS,CAACC,KAAd,CAAoBjC,QAAQ,CAACkC,cAAT,CAAwB,aAAxB,CAApB,CAAd;AAEH;AArE4B,CAAf,CAAlB;AAyEAnB,SAAS,CAACP,KAAV,CAAgB,YAAhB","file":"all.js","sourcesContent":["const url = 'https://vue3-course-api.hexschool.io/v2';\nconst path = 'erinhuang-lab';\n\n\n\n\n\n\n","const deletemodal = {\r\n    props: ['tempProduct'],\r\n    methods: {\r\n        deleteProduct() {\r\n            let newUrl = `${url}/api/${path}/admin/product/${this.tempProduct.id}`;\r\n            axios.delete(newUrl, { data: this.tempProduct})\r\n            .then((res) => {\r\n                deleteModal.hide();\r\n                this.$emit('get-products');      \r\n            })\r\n            .catch((error) => {\r\n                console.dir(error);\r\n            })\r\n        }      \r\n    },\r\n    template: `<div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n        <div class=\"modal-header bg-danger text-white\">\r\n            <h5 class=\"modal-title\" id=\"deleteModalLabel\">刪除產品</h5>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n            <p>是否刪除 <span class=\"text-danger\">{{ tempProduct.title }}</span> 商品（刪除後將無法恢復）？</p> \r\n        </div>\r\n        <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-bs-dismiss=\"modal\">取消</button>\r\n            <button type=\"button\" class=\"btn btn-danger\" @click=\"deleteProduct\">確認刪除</button>\r\n        </div>\r\n        </div>\r\n    </div>`\r\n}","// 串接登入 API\r\nconst loginApp = Vue.createApp ({\r\n    data() {\r\n        return {\r\n            user: {\r\n                username: '',\r\n                password: '',\r\n            }\r\n        }\r\n    },\r\n  \r\n    methods: {\r\n        login () {\r\n            axios.post(`${url}/admin/signin`, this.user)\r\n            .then((res) => {\r\n                // 將 token 存在 cookie\r\n                const { token, expired } = res.data;\r\n                document.cookie = `userToken=${token}; expires=${new Date(expired)}GMT;`;\r\n                // 跳轉頁面\r\n                window.alert(`${res.data.message}，即將進入商品頁面`);\r\n                window.location.href = 'update-product.html';\r\n            })\r\n            .catch((error) => {\r\n                window.alert(`登入失敗，請重新輸入一次`);\r\n                console.dir(error);\r\n            })\r\n        }\r\n    }\r\n  \r\n  })\r\n  \r\n  loginApp.mount('#loginApp');","const pagination = {\r\n    props: ['pages'],\r\n    template: `<nav aria-label=\"Page navigation example\">\r\n    <ul class=\"pagination\">\r\n        <li class=\"page-item\" :class=\"{disabled: !pages.has_pre}\">\r\n            <a class=\"page-link\" href=\"#\" aria-label=\"Previous\" @click=\"$emit('get-product', page = 1)\">\r\n                <span aria-hidden=\"true\">&laquo;</span>\r\n            </a>\r\n        </li>\r\n        <li class=\"page-item\" :class=\"{ active: page === pages.current_page}\" v-for=\"page in pages.total_pages\" :key=\"page\">\r\n            <a class=\"page-link\" href=\"#\" @click=\"$emit('get-product', page)\">{{ page }}</a>\r\n        </li>\r\n        <li class=\"page-item\" :class=\"{disabled: !pages.has_next}\">\r\n            <a class=\"page-link\" href=\"#\" aria-label=\"Next\" @click=\"$emit('get-product', page = pages.total_pages)\">\r\n                <span aria-hidden=\"true\">&raquo;</span>\r\n            </a>\r\n        </li>\r\n    </ul>\r\n  </nav>`\r\n}","const updatemodal = {\r\n    props: ['tempProduct', 'isNew'],\r\n    methods: {\r\n        updateProduct() {\r\n            let newUrl = `${url}/api/${path}/admin/product`;\r\n            let method = 'post';\r\n            // 如果是編輯模式，api位址和介接方法變動為\r\n            if (!this.isNew) {\r\n                newUrl = `${url}/api/${path}/admin/product/${this.tempProduct.id}`;\r\n                method = 'put';            \r\n            }\r\n\r\n            axios[method](newUrl, { data: this.tempProduct})\r\n            .then((res) => {\r\n                this.$emit('get-products');\r\n                updateModal.hide();\r\n            })\r\n            .catch((error) => {\r\n                console.dir(error);\r\n            })\r\n        }\r\n    },\r\n    template: `<div class=\"modal-dialog modal-xl\">\r\n        <div class=\"modal-content\">\r\n        <div class=\"modal-header bg-dark text-white\">\r\n            <h5 class=\"modal-title\" id=\"updateModalLabel\">新增產品</h5>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n            <div class=\"row\">\r\n            <!-- modal-start -->\r\n            <div class=\"col-4\">\r\n                <div class=\"mb-5\">\r\n                <label for=\"imgUrl\" class=\"form-label\">主要圖片</label>\r\n                <input type=\"text\" class=\"form-control mb-2\" name=\"img-url\" id=\"imgUrl\" placeholder=\"請輸入圖片連結\" v-model=\"tempProduct.imageUrl\">\r\n                <img :src=\"tempProduct.imageUrl\" class=\"img-fluid\"> \r\n                </div>\r\n                <div>\r\n                <!-- 多圖新增 -->\r\n                <h3 class=\"mb-3\">多圖新增</h3>\r\n                <!-- 先判斷 tempProduct.imagesUrl 是否為陣列資料-->\r\n                <div v-if=\"Array.isArray(tempProduct.imagesUrl)\">\r\n                    <div v-for=\"(img, key) in tempProduct.imagesUrl\" :key=\"key + 12345\">\r\n                    <input type=\"text\" class=\"form-control mb-2\" name=\"img-url\" id=\"imgUrl\" placeholder=\"請輸入圖片連結\" v-model=\"tempProduct.imagesUrl[key]\">\r\n                    <img :src=\"tempProduct.imagesUrl[key]\" class=\"img-fluid mb-2\">                             \r\n                    </div>\r\n                    <!-- 新增按鈕的進階判斷：1.陣列為空陣列 2.陣列最後一筆資料有內容 -->\r\n                    <button type=\"button\" class=\"btn btn-primary btn-sm w-100 mb-2\" \r\n                    v-if=\"!tempProduct.imagesUrl.length || tempProduct.imagesUrl[tempProduct.imagesUrl.length - 1]\" @click=\"tempProduct.imagesUrl.push('')\">新增圖片</button>\r\n                    <button type=\"button\" class=\"btn btn-outline-danger btn-sm w-100\" \r\n                    v-else @click=\"tempProduct.imagesUrl.pop()\">刪除最後一筆圖片</button>\r\n                </div>\r\n                </div>\r\n            </div>\r\n            <!-- modal-end -->\r\n            <div class=\"col-8\">\r\n                <!-- modal-end-top -->\r\n                <div class=\"pb-4 border-bottom mb-3\">\r\n                <div class=\"mb-3\">\r\n                    <label for=\"productTitle\" class=\"form-label\">標題</label>\r\n                    <input type=\"text\" class=\"form-control mb-2\" name=\"product-title\" \r\n                    id=\"productTitle\" placeholder=\"請輸入標題\" v-model=\"tempProduct.title\" autocomplete=\"on\">\r\n                </div>\r\n                <div class=\"row\">\r\n                    <div class=\"col\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"productCategory\" class=\"form-label\">分類</label>\r\n                        <input type=\"text\" class=\"form-control mb-2\" name=\"product-category\" \r\n                        id=\"productCategory\" placeholder=\"請輸入分類\" v-model=\"tempProduct.category\" autocomplete=\"on\">\r\n                    </div>                      \r\n                    </div>\r\n                    <div class=\"col\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"productUnit\" class=\"form-label\">單位</label>\r\n                        <input type=\"text\" class=\"form-control mb-2\" name=\"product-unit\" \r\n                        id=\"productUnit\" placeholder=\"請輸入單位\" v-model=\"tempProduct.unit\" autocomplete=\"on\">\r\n                    </div> \r\n                    </div>\r\n                </div>\r\n                <div class=\"row\">\r\n                    <div class=\"col\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"productPrice\" class=\"form-label\">原價</label>\r\n                        <input type=\"text\" class=\"form-control mb-2\" name=\"product-price\" \r\n                        id=\"productPrice\" placeholder=\"請輸入原價\" v-model.number=\"tempProduct.origin_price\" autocomplete=\"on\">\r\n                    </div>                      \r\n                    </div>\r\n                    <div class=\"col\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"productSalePrice\" class=\"form-label\">售價</label>\r\n                        <input type=\"text\" class=\"form-control mb-2\" name=\"product-sale-price\" \r\n                        id=\"productSalePrice\" placeholder=\"請輸入售價\" v-model.number=\"tempProduct.price\" autocomplete=\"on\">\r\n                    </div> \r\n                    </div>\r\n                </div>\r\n                </div>\r\n                <!-- modal-end-bottom -->\r\n                <div class=\"pb-4\">\r\n                <div class=\"mb-3\">\r\n                    <label for=\"productDescription\" class=\"form-label\">產品描述</label>\r\n                    <textarea class=\"form-control mb-2\" id=\"productDescription\" rows=\"2\" placeholder=\"請輸入產品描述\" v-model=\"tempProduct.description\"></textarea>\r\n                </div>\r\n                <div class=\"mb-3\">\r\n                    <label for=\"productDetail\" class=\"form-label\">說明內容</label>\r\n                    <textarea class=\"form-control mb-2\" id=\"productDetail\" rows=\"2\" placeholder=\"請輸入說明內容\" v-model=\"tempProduct.content\"></textarea>\r\n                </div>   \r\n                <div class=\"form-check\">\r\n                    <input type=\"checkbox\" class=\"form-check-input\" value=\"\" id=\"is_enabled\" v-model=\"tempProduct.is_enabled\"\r\n                    :true-value=\"1\" :false-value=\"0\">\r\n                    <label for=\"is_enabled\" class=\"form-check-label\">是否啟用</label>\r\n                </div>                  \r\n                </div>\r\n            </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-bs-dismiss=\"modal\">取消</button>\r\n            <button type=\"button\" class=\"btn btn-primary\" @click=\"updateProduct\">確認</button>\r\n        </div>\r\n        </div>\r\n    </div>`\r\n}","let updateModal = {};\r\nlet deleteModal = {};\r\n\r\nconst updateApp = Vue.createApp ({\r\n    data() {\r\n        return {\r\n            products: [],\r\n            tempProduct: {\r\n                imagesUrl: [],\r\n            },\r\n            isNew: false,\r\n            pagination: {}\r\n        }\r\n    },\r\n  \r\n    methods: {\r\n        checkLogin() {\r\n            axios.post(`${url}/api/user/check`)\r\n            .then((res) => {\r\n                this.getProducts();\r\n            })            \r\n            .catch((error) => {\r\n                window.alert(`驗證失敗，請重新登入`);\r\n                window.location.href = 'index.html';                \r\n            })\r\n        },\r\n        getProducts(page = 1) {\r\n            // API位址加入頁數變數\r\n            axios.get(`${url}/api/${path}/admin/products?page=${page}`)\r\n            .then((res) => {\r\n                this.products = res.data.products;\r\n                this.pagination = res.data.pagination;\r\n            })\r\n            .catch((error) => {\r\n                window.alert('error');\r\n            })   \r\n        },\r\n        openModal(status, product) {\r\n            // 新增、編輯共用的判斷\r\n            if (status === 'isNew') {\r\n                this.tempProduct = {\r\n                    imagesUrl: []\r\n                }\r\n                updateModal.show();\r\n                this.isNew = true;\r\n            } else if (status === 'edit') {\r\n                this.tempProduct = { ...product }\r\n                updateModal.show();  \r\n            // 刪除的判斷        \r\n            } else if (status === 'delete') {\r\n                this.tempProduct = { ...product }\r\n                deleteModal.show();\r\n            }\r\n        },\r\n        \r\n    },\r\n\r\n    components: {\r\n        pagination,\r\n        updatemodal,\r\n        deletemodal\r\n    },\r\n\r\n    mounted() {\r\n        const token = document.cookie.replace(/(?:(?:^|.*;\\s*)userToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n        axios.defaults.headers.common['Authorization'] = token;\r\n\r\n        this.checkLogin();\r\n\r\n        updateModal = new bootstrap.Modal(document.getElementById('updateModal'));\r\n        deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));\r\n        \r\n    }\r\n  \r\n})\r\n  \r\nupdateApp.mount('#updateApp');"]}