{"version":3,"sources":["all.js","login.js","update.js"],"names":["url","path","loginApp","Vue","createApp","data","user","username","password","methods","login","axios","post","then","res","token","expired","document","cookie","Date","window","alert","message","location","href","error","console","dir","mount","updateModal","deleteModal","updateApp","products","tempProduct","imagesUrl","isNew","checkLogin","getProducts","get","openModal","status","product","show","updateProduct","newUrl","method","id","hide","deleteProduct","mounted","replace","defaults","headers","common","bootstrap","Modal","getElementById"],"mappings":"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","file":"all.js","sourcesContent":["const url = 'https://vue3-course-api.hexschool.io/v2';\nconst path = 'erinhuang-lab';\n\n\n\n\n\n\n","// 串接登入 API\r\nconst loginApp = Vue.createApp ({\r\n    data() {\r\n        return {\r\n            user: {\r\n                username: '',\r\n                password: '',\r\n            }\r\n        }\r\n    },\r\n  \r\n    methods: {\r\n        login () {\r\n            axios.post(`${url}/admin/signin`, this.user)\r\n            .then((res) => {\r\n                // 將 token 存在 cookie\r\n                const { token, expired } = res.data;\r\n                document.cookie = `userToken=${token}; expires=${new Date(expired)}GMT;`;\r\n                // 跳轉頁面\r\n                window.alert(`${res.data.message}，即將進入商品頁面`);\r\n                window.location.href = 'update-product.html';\r\n            })\r\n            .catch((error) => {\r\n                window.alert(`登入失敗，請重新輸入一次`);\r\n                console.dir(error);\r\n            })\r\n        }\r\n    }\r\n  \r\n  })\r\n  \r\n  loginApp.mount('#loginApp');","let updateModal = {};\r\nlet deleteModal = {};\r\n\r\nconst updateApp = Vue.createApp ({\r\n    data() {\r\n        return {\r\n            user: {\r\n                username: '',\r\n                password: ''\r\n            },\r\n            products: [],\r\n            tempProduct: {\r\n                imagesUrl: [],\r\n            },\r\n            isNew: false,\r\n        }\r\n    },\r\n  \r\n    methods: {\r\n        checkLogin() {\r\n            axios.post(`${url}/api/user/check`)\r\n            .then((res) => {\r\n                this.getProducts();\r\n            })            \r\n            .catch((error) => {\r\n                window.alert(`驗證失敗，請重新登入`);\r\n                window.location.href = 'index.html';                \r\n            })\r\n        },\r\n        getProducts() {\r\n            axios.get(`${url}/api/${path}/admin/products`)\r\n            .then((res) => {\r\n                this.products = res.data.products;\r\n            })\r\n            .catch((error) => {\r\n                window.alert('error');\r\n            })   \r\n        },\r\n        openModal(status, product) {\r\n            // 新增、編輯共用的判斷\r\n            if (status === 'isNew') {\r\n                this.tempProduct = {\r\n                    imagesUrl: []\r\n                }\r\n                updateModal.show();\r\n                this.isNew = true;\r\n            } else if (status === 'edit') {\r\n                this.tempProduct = { ...product }\r\n                updateModal.show();  \r\n            // 刪除的判斷        \r\n            } else if (status === 'delete') {\r\n                this.tempProduct = { ...product }\r\n                deleteModal.show();\r\n            }\r\n        },\r\n        updateProduct() {\r\n            let newUrl = `${url}/api/${path}/admin/product`;\r\n            let method = 'post';\r\n            // 如果是編輯模式，api位址和介接方法變動為\r\n            if (!this.isNew) {\r\n                newUrl = `${url}/api/${path}/admin/product/${this.tempProduct.id}`;\r\n                method = 'put';            \r\n            }\r\n\r\n            axios[method](newUrl, { data: this.tempProduct})\r\n            .then((res) => {\r\n                this.getProducts();\r\n                updateModal.hide();\r\n            })\r\n            .catch((error) => {\r\n                console.dir(error);\r\n            })\r\n        },\r\n        deleteProduct() {\r\n            let newUrl = `${url}/api/${path}/admin/product/${this.tempProduct.id}`;\r\n            axios.delete(newUrl, { data: this.tempProduct})\r\n            .then((res) => {\r\n                deleteModal.hide();\r\n                this.getProducts();       \r\n            })\r\n            .catch((error) => {\r\n                console.dir(error);\r\n            })\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        const token = document.cookie.replace(/(?:(?:^|.*;\\s*)userToken\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n        axios.defaults.headers.common['Authorization'] = token;\r\n\r\n        this.checkLogin();\r\n\r\n        updateModal = new bootstrap.Modal(document.getElementById('updateModal'));\r\n        deleteModal = new bootstrap.Modal(document.getElementById('deleteModal'));\r\n        \r\n    }\r\n  \r\n  })\r\n  \r\n  updateApp.mount('#updateApp');"]}